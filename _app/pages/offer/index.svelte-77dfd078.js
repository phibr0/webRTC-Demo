import{S,i as v,s as D,e as k,c as b,a as y,d as u,b as C,f as m,n as p,o as j,p as _,u as I,m as E,v as d,w as h,x as g,A as $,I as O,j as R,t as x,l as z,g as A,H as M,K as N}from"../../chunks/vendor-f6322723.js";import{R as w,I as T,C as q,a as F,S as G}from"../../chunks/static-9a39eb64.js";function H(o){let n,t;return n=new q({props:{channel:o[0].channel}}),{c(){d(n.$$.fragment)},l(e){h(n.$$.fragment,e)},m(e,a){g(n,e,a),t=!0},p(e,a){const l={};a&1&&(l.channel=e[0].channel),n.$set(l)},i(e){t||(_(n.$$.fragment,e),t=!0)},o(e){p(n.$$.fragment,e),t=!1},d(e){$(n,e)}}}function K(o){let n,t;return n=new F({}),{c(){d(n.$$.fragment)},l(e){h(n.$$.fragment,e)},m(e,a){g(n,e,a),t=!0},p:O,i(e){t||(_(n.$$.fragment,e),t=!0)},o(e){p(n.$$.fragment,e),t=!1},d(e){$(n,e)}}}function L(o){let n,t,e,a,l,c,i;return n=new G({props:{sdp:o[2]}}),{c(){d(n.$$.fragment),t=R(),e=k("p"),a=x("Done"),this.h()},l(s){h(n.$$.fragment,s),t=z(s),e=b(s,"P",{class:!0});var r=y(e);a=A(r,"Done"),r.forEach(u),this.h()},h(){C(e,"class","btn svelte-1eccz5j")},m(s,r){g(n,s,r),m(s,t,r),m(s,e,r),M(e,a),l=!0,c||(i=N(e,"click",o[3]),c=!0)},p(s,r){const f={};r&4&&(f.sdp=s[2]),n.$set(f)},i(s){l||(_(n.$$.fragment,s),l=!0)},o(s){p(n.$$.fragment,s),l=!1},d(s){$(n,s),s&&u(t),s&&u(e),c=!1,i()}}}function P(o){let n,t,e,a;const l=[L,K,H],c=[];function i(s,r){return s[1]==="offering"?0:s[1]==="scanning"?1:s[1]==="chatting"?2:-1}return~(t=i(o))&&(e=c[t]=l[t](o)),{c(){n=k("main"),e&&e.c(),this.h()},l(s){n=b(s,"MAIN",{class:!0});var r=y(n);e&&e.l(r),r.forEach(u),this.h()},h(){C(n,"class","svelte-1eccz5j")},m(s,r){m(s,n,r),~t&&c[t].m(n,null),a=!0},p(s,[r]){let f=t;t=i(s),t===f?~t&&c[t].p(s,r):(e&&(E(),p(c[f],1,1,()=>{c[f]=null}),j()),~t?(e=c[t],e?e.p(s,r):(e=c[t]=l[t](s),e.c()),_(e,1),e.m(n,null)):e=null)},i(s){a||(_(e),a=!0)},o(s){p(e),a=!1},d(s){s&&u(n),~t&&c[t].d()}}}function V(o,n,t){let e,a="offering",l;return I(()=>{addEventListener("scan",async i=>{if(w.isValidSessionDescription(i.detail.data)){const s={type:"answer",sdp:i.detail.data};e.setRemoteDescription(s)}}),t(0,e=new w(T,"offer",!0)),t(0,e.onOpen=()=>t(1,a="chatting"),e),t(0,e.onClose=()=>location.href="https://phibr0.de/webRTC-Demo",e),t(2,l=e.generateOffer(1e3))}),[e,a,l,()=>t(1,a="scanning")]}class Q extends S{constructor(n){super();v(this,n,V,P,D,{})}}export{Q as default};
