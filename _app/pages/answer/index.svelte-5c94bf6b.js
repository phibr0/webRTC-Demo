import{S as b,i as k,s as y,e as w,c as C,a as S,d as g,b as I,f as v,n as l,o as A,p as f,u as D,m as R,v as _,w as m,x as d,A as h,I as E}from"../../chunks/vendor-f6322723.js";import{R as $,I as j,C as x,S as M,a as N}from"../../chunks/static-9a39eb64.js";function O(i){let n,t;return n=new x({props:{channel:i[0].channel}}),{c(){_(n.$$.fragment)},l(e){m(n.$$.fragment,e)},m(e,r){d(n,e,r),t=!0},p(e,r){const a={};r&1&&(a.channel=e[0].channel),n.$set(a)},i(e){t||(f(n.$$.fragment,e),t=!0)},o(e){l(n.$$.fragment,e),t=!1},d(e){h(n,e)}}}function T(i){let n,t;return n=new M({props:{sdp:i[2]}}),{c(){_(n.$$.fragment)},l(e){m(n.$$.fragment,e)},m(e,r){d(n,e,r),t=!0},p(e,r){const a={};r&4&&(a.sdp=e[2]),n.$set(a)},i(e){t||(f(n.$$.fragment,e),t=!0)},o(e){l(n.$$.fragment,e),t=!1},d(e){h(n,e)}}}function q(i){let n,t;return n=new N({}),{c(){_(n.$$.fragment)},l(e){m(n.$$.fragment,e)},m(e,r){d(n,e,r),t=!0},p:E,i(e){t||(f(n.$$.fragment,e),t=!0)},o(e){l(n.$$.fragment,e),t=!1},d(e){h(n,e)}}}function F(i){let n,t,e,r;const a=[q,T,O],o=[];function u(s,c){return s[1]==="scanning"?0:s[1]==="offering"?1:s[1]==="chatting"?2:-1}return~(t=u(i))&&(e=o[t]=a[t](i)),{c(){n=w("main"),e&&e.c(),this.h()},l(s){n=C(s,"MAIN",{class:!0});var c=S(n);e&&e.l(c),c.forEach(g),this.h()},h(){I(n,"class","svelte-6uxsi8")},m(s,c){v(s,n,c),~t&&o[t].m(n,null),r=!0},p(s,[c]){let p=t;t=u(s),t===p?~t&&o[t].p(s,c):(e&&(R(),l(o[p],1,1,()=>{o[p]=null}),A()),~t?(e=o[t],e?e.p(s,c):(e=o[t]=a[t](s),e.c()),f(e,1),e.m(n,null)):e=null)},i(s){r||(f(e),r=!0)},o(s){l(e),r=!1},d(s){s&&g(n),~t&&o[t].d()}}}function G(i,n,t){let e,r="scanning",a;return D(()=>{addEventListener("scan",async o=>{if($.isValidSessionDescription(o.detail.data)){t(1,r="offering");const u={type:"offer",sdp:o.detail.data};t(0,e=new $(j,"answer",!0)),t(0,e.onOpen=()=>t(1,r="chatting"),e),t(0,e.onClose=()=>location.href="https://phibr0.de/webRTC-Demo",e),await e.setRemoteDescription(u),t(2,a=e.generateAnswer(1e3))}})}),[e,r,a]}class z extends b{constructor(n){super();k(this,n,G,F,y,{})}}export{z as default};
