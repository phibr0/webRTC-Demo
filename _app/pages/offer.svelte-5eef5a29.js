import{S as M,i as P,s as R,e as k,c as $,a as v,d as _,b as C,f as h,n as d,o as A,p as g,u as I,m as O,v as b,w as y,x as w,A as D,I as Q,t as S,j,g as q,l as E,H as L,K as T}from"../chunks/vendor-3d38fcf1.js";import{C as U,S as x,Q as H}from"../chunks/qrcode-655654b5.js";/* empty css                                                   */function K(i){let n,t;return n=new U({props:{channel:i[0]}}),{c(){b(n.$$.fragment)},l(e){y(n.$$.fragment,e)},m(e,r){w(n,e,r),t=!0},p(e,r){const l={};r&1&&(l.channel=e[0]),n.$set(l)},i(e){t||(g(n.$$.fragment,e),t=!0)},o(e){d(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function N(i){let n,t;return n=new x({props:{type:"answer"}}),{c(){b(n.$$.fragment)},l(e){y(n.$$.fragment,e)},m(e,r){w(n,e,r),t=!0},p:Q,i(e){t||(g(n.$$.fragment,e),t=!0)},o(e){d(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function z(i){let n,t,e,r,l,c,f,s,a,p;return r=new H({props:{data:i[2]}}),{c(){n=k("p"),t=S("Let the other User scan this Code"),e=j(),b(r.$$.fragment),l=j(),c=k("p"),f=S("Done"),this.h()},l(o){n=$(o,"P",{class:!0});var u=v(n);t=q(u,"Let the other User scan this Code"),u.forEach(_),e=E(o),y(r.$$.fragment,o),l=E(o),c=$(o,"P",{class:!0});var m=v(c);f=q(m,"Done"),m.forEach(_),this.h()},h(){C(n,"class","svelte-phd96k"),C(c,"class","btn svelte-phd96k")},m(o,u){h(o,n,u),L(n,t),h(o,e,u),w(r,o,u),h(o,l,u),h(o,c,u),L(c,f),s=!0,a||(p=T(c,"click",i[3]),a=!0)},p(o,u){const m={};u&4&&(m.data=o[2]),r.$set(m)},i(o){s||(g(r.$$.fragment,o),s=!0)},o(o){d(r.$$.fragment,o),s=!1},d(o){o&&_(n),o&&_(e),D(r,o),o&&_(l),o&&_(c),a=!1,p()}}}function B(i){let n,t,e,r;const l=[z,N,K],c=[];function f(s,a){return s[1]==="offering"?0:s[1]==="scanning"?1:s[1]==="chatting"?2:-1}return~(t=f(i))&&(e=c[t]=l[t](i)),{c(){n=k("main"),e&&e.c(),this.h()},l(s){n=$(s,"MAIN",{class:!0});var a=v(n);e&&e.l(a),a.forEach(_),this.h()},h(){C(n,"class","svelte-phd96k")},m(s,a){h(s,n,a),~t&&c[t].m(n,null),r=!0},p(s,[a]){let p=t;t=f(s),t===p?~t&&c[t].p(s,a):(e&&(O(),d(c[p],1,1,()=>{c[p]=null}),A()),~t?(e=c[t],e?e.p(s,a):(e=c[t]=l[t](s),e.c()),g(e,1),e.m(n,null)):e=null)},i(s){r||(g(e),r=!0)},o(s){d(e),r=!1},d(s){s&&_(n),~t&&c[t].d()}}}function F(i,n,t){let e,r="offering",l;return I(()=>{const f={};f.iceServers=[],f.iceServers.push({urls:"stun:stun1.l.google.com:19302"});const s=new RTCPeerConnection(f);s.onicecandidate=a=>{t(2,l=s.localDescription.sdp)},t(0,e=s.createDataChannel("sendChannel")),t(0,e.onmessage=a=>console.log("Message received: "+a.data),e),t(0,e.onopen=a=>{console.log("Connection opened."),t(1,r="chatting")},e),t(0,e.onclose=a=>{console.log("Connection closed."),location.href="https://phibr0.de/webRTC-Demo"},e),s.createOffer().then(a=>s.setLocalDescription(a)),addEventListener("scan",async a=>{const p=a.detail.sdp;s.setRemoteDescription(p)})}),[e,r,l,()=>t(1,r="scanning")]}class W extends M{constructor(n){super();P(this,n,F,B,R,{})}}export{W as default};
