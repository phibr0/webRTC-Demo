import{S as L,i as M,s as O,e as m,c as h,a as d,d as u,b as g,f as p,n as k,o as P,p as v,u as I,m as J,J as R,K as U,v as b,w,x as S,A as D,I as C,t as $,j as E,g as N,l as j,H as A,M as q}from"../chunks/vendor-efad3a29.js";import{C as H,S as K}from"../chunks/scanner-557f655c.js";/* empty css                                                   */function T(i){let t,n;return t=new H({props:{channel:i[1]}}),{c(){b(t.$$.fragment)},l(e){w(t.$$.fragment,e)},m(e,o){S(t,e,o),n=!0},p(e,o){const l={};o&2&&(l.channel=e[1]),t.$set(l)},i(e){n||(v(t.$$.fragment,e),n=!0)},o(e){k(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function V(i){let t,n;return t=new K({}),{c(){b(t.$$.fragment)},l(e){w(t.$$.fragment,e)},m(e,o){S(t,e,o),n=!0},p:C,i(e){n||(v(t.$$.fragment,e),n=!0)},o(e){k(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function x(i){let t,n,e,o,l,c,_,a,r;return{c(){t=m("p"),n=$("Let the other User scan this Code"),e=E(),o=m("canvas"),l=E(),c=m("p"),_=$("Done"),this.h()},l(s){t=h(s,"P",{class:!0});var f=d(t);n=N(f,"Let the other User scan this Code"),f.forEach(u),e=j(s),o=h(s,"CANVAS",{class:!0}),d(o).forEach(u),l=j(s),c=h(s,"P",{class:!0});var y=d(c);_=N(y,"Done"),y.forEach(u),this.h()},h(){g(t,"class","svelte-1kwy305"),g(o,"class","svelte-1kwy305"),g(c,"class","btn svelte-1kwy305")},m(s,f){p(s,t,f),A(t,n),p(s,e,f),p(s,o,f),i[3](o),p(s,l,f),p(s,c,f),A(c,_),a||(r=q(c,"click",i[4]),a=!0)},p:C,i:C,o:C,d(s){s&&u(t),s&&u(e),s&&u(o),i[3](null),s&&u(l),s&&u(c),a=!1,r()}}}function z(i){let t,n,e,o;const l=[x,V,T],c=[];function _(a,r){return a[2]==="offering"?0:a[2]==="scanning"?1:a[2]==="chatting"?2:-1}return~(n=_(i))&&(e=c[n]=l[n](i)),{c(){t=m("main"),e&&e.c(),this.h()},l(a){t=h(a,"MAIN",{class:!0});var r=d(t);e&&e.l(r),r.forEach(u),this.h()},h(){g(t,"class","svelte-1kwy305")},m(a,r){p(a,t,r),~n&&c[n].m(t,null),o=!0},p(a,[r]){let s=n;n=_(a),n===s?~n&&c[n].p(a,r):(e&&(J(),k(c[s],1,1,()=>{c[s]=null}),P()),~n?(e=c[n],e?e.p(a,r):(e=c[n]=l[n](a),e.c()),v(e,1),e.m(t,null)):e=null)},i(a){o||(v(e),o=!0)},o(a){k(e),o=!1},d(a){a&&u(t),~n&&c[n].d()}}}function B(i,t,n){let e,o,l="offering";I(()=>{const a={};a.iceServers=[],a.iceServers.push({urls:"stun:stun1.l.google.com:19302"});const r=new RTCPeerConnection(a);r.onicecandidate=s=>{console.log("New ICE Candidate, reprinting SDP:"),console.log(JSON.stringify(r.localDescription)),R.toCanvas(e,JSON.stringify(r.localDescription),console.error)},n(1,o=r.createDataChannel("sendChannel")),n(1,o.onmessage=s=>console.log("Message received: "+s.data),o),n(1,o.onopen=s=>{console.log("Connection opened."),n(2,l="chatting")},o),n(1,o.onclose=s=>console.log("Connection closed."),o),r.createOffer().then(s=>r.setLocalDescription(s)),addEventListener("scan",async s=>{const f=s.detail.sdp;r.setRemoteDescription(f)})});function c(a){U[a?"unshift":"push"](()=>{e=a,n(0,e)})}return[e,o,l,c,()=>n(2,l="scanning")]}class W extends L{constructor(t){super();M(this,t,B,z,O,{})}}export{W as default};
