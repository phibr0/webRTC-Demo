import{S as D,i as N,s as V,k as O,f as I,d as u,e as _,j as P,t as M,c as f,a as g,l as Q,g as w,b as v,H as p,L as j,M as F,I as y,N as z,O as B,u as U,P as k,h as L,Q as J,T,U as K}from"./vendor-2fef0dfb.js";function G(c,e,s){const a=c.slice();return a[5]=e[s],a}function R(c){let e,s,a=c[5].data+"",n,t;return{c(){e=_("div"),s=_("span"),n=M(a),this.h()},l(l){e=f(l,"DIV",{class:!0});var i=g(e);s=f(i,"SPAN",{});var h=g(s);n=w(h,a),h.forEach(u),i.forEach(u),this.h()},h(){v(e,"class",t=""+(k(c[5].type)+" svelte-16ca9vt"))},m(l,i){I(l,e,i),p(e,s),p(s,n)},p(l,i){i&1&&a!==(a=l[5].data+"")&&L(n,a),i&1&&t!==(t=""+(k(l[5].type)+" svelte-16ca9vt"))&&v(e,"class",t)},d(l){l&&u(e)}}}function W(c){let e,s,a=c[5].data+"",n,t;return{c(){e=_("div"),s=_("span"),n=M(a),this.h()},l(l){e=f(l,"DIV",{class:!0});var i=g(e);s=f(i,"SPAN",{});var h=g(s);n=w(h,a),h.forEach(u),i.forEach(u),this.h()},h(){v(e,"class",t=""+(k(c[5].type)+" svelte-16ca9vt"))},m(l,i){I(l,e,i),p(e,s),p(s,n)},p(l,i){i&1&&a!==(a=l[5].data+"")&&L(n,a),i&1&&t!==(t=""+(k(l[5].type)+" svelte-16ca9vt"))&&v(e,"class",t)},d(l){l&&u(e)}}}function H(c){let e;function s(t,l){return t[5].type==="incoming"?W:R}let a=s(c),n=a(c);return{c(){n.c(),e=O()},l(t){n.l(t),e=O()},m(t,l){n.m(t,l),I(t,e,l)},p(t,l){a===(a=s(t))&&n?n.p(t,l):(n.d(1),n=a(t),n&&(n.c(),n.m(e.parentNode,e)))},d(t){n.d(t),t&&u(e)}}}function X(c){let e,s,a,n,t,l,i,h,S,A,E=c[0],d=[];for(let r=0;r<E.length;r+=1)d[r]=H(G(c,E,r));return{c(){e=_("main"),s=_("div");for(let r=0;r<d.length;r+=1)d[r].c();a=P(),n=_("div"),t=_("input"),l=P(),i=_("div"),h=M("Send"),this.h()},l(r){e=f(r,"MAIN",{class:!0});var m=g(e);s=f(m,"DIV",{class:!0});var o=g(s);for(let C=0;C<d.length;C+=1)d[C].l(o);o.forEach(u),a=Q(m),n=f(m,"DIV",{class:!0});var b=g(n);t=f(b,"INPUT",{type:!0,class:!0}),l=Q(b),i=f(b,"DIV",{class:!0});var q=g(i);h=w(q,"Send"),q.forEach(u),b.forEach(u),m.forEach(u),this.h()},h(){v(s,"class","messages svelte-16ca9vt"),v(t,"type","text"),v(t,"class","svelte-16ca9vt"),v(i,"class","btn svelte-16ca9vt"),v(n,"class","input svelte-16ca9vt"),v(e,"class","svelte-16ca9vt")},m(r,m){I(r,e,m),p(e,s);for(let o=0;o<d.length;o+=1)d[o].m(s,null);p(e,a),p(e,n),p(n,t),j(t,c[1]),p(n,l),p(n,i),p(i,h),S||(A=[F(t,"input",c[4]),F(i,"click",c[2])],S=!0)},p(r,[m]){if(m&1){E=r[0];let o;for(o=0;o<E.length;o+=1){const b=G(r,E,o);d[o]?d[o].p(b,m):(d[o]=H(b),d[o].c(),d[o].m(s,null))}for(;o<d.length;o+=1)d[o].d(1);d.length=E.length}m&2&&t.value!==r[1]&&j(t,r[1])},i:y,o:y,d(r){r&&u(e),z(d,r),S=!1,B(A)}}}function Y(c,e,s){let{channel:a}=e,n=[],t="";U(()=>s(3,a.onmessage=({data:h})=>s(0,n=[...n,{type:"incoming",data:h}]),a));function l(){t&&(s(0,n=[...n,{type:"outgoing",data:t}]),a.send(t),s(1,t=""))}function i(){t=this.value,s(1,t)}return c.$$set=h=>{"channel"in h&&s(3,a=h.channel)},[n,t,l,a,i]}class se extends D{constructor(e){super();N(this,e,Y,X,V,{channel:3})}}function Z(c){let e;return{c(){e=_("video"),this.h()},l(s){e=f(s,"VIDEO",{}),g(e).forEach(u),this.h()},h(){e.autoplay=!0},m(s,a){I(s,e,a),c[1](e)},p:y,i:y,o:y,d(s){s&&u(e),c[1](null)}}}function x(c,e,s){let a;U(()=>{navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1}).then(t=>{s(0,a.srcObject=t,a),new J().decodeFromVideo(a).then(i=>{dispatchEvent(new CustomEvent("scan",{detail:{data:i.data}}))})}).catch(t=>{console.error(t)})});function n(t){T[t?"unshift":"push"](()=>{a=t,s(0,a)})}return[a,n]}class ae extends D{constructor(e){super();N(this,e,x,Z,V,{})}}function $(c){let e;return{c(){e=_("canvas"),this.h()},l(s){e=f(s,"CANVAS",{class:!0}),g(e).forEach(u),this.h()},h(){v(e,"class","svelte-ewlrv4")},m(s,a){I(s,e,a),c[2](e)},p:y,i:y,o:y,d(s){s&&u(e),c[2](null)}}}function ee(c,e,s){let{data:a}=e,n;function t(l){T[l?"unshift":"push"](()=>{n=l,s(0,n)})}return c.$$set=l=>{"data"in l&&s(1,a=l.data)},c.$$.update=()=>{c.$$.dirty&3&&a&&K.toCanvas(n,a,{margin:2,errorCorrectionLevel:"low"})},[n,a,t]}class ne extends D{constructor(e){super();N(this,e,ee,$,V,{data:1})}}const le={iceServers:[{urls:"stun:stun1.l.google.com:19302"}]};export{se as C,le as I,ne as Q,ae as S};
